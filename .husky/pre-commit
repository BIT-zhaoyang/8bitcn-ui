echo '🪓🏗️👹 Preparing orc axes for the mighty project conquest! 👹🏗️🪓'
echo 'Get ready for battle, this may take a while...'

# Check Orcish Code Standards
npx lint-staged

pnpm lint ||
(
    echo "⚔️❌ Grargh, you have encountered an issue in your code. Check the orcish runes! ⚔️❌
          Run pnpm lint, make changes, and try the conquest again.";
    false;
)

echo '🎉 No problems found: initiating orcish conquest now.... ✨🚀🏹🛡️'

pnpm registry:build 

TARGET_FILE="public/r"
DIFF_OUTPUT=$(git diff -- "$TARGET_FILE")
if [ -n "$DIFF_OUTPUT" ]; then
  echo "⚔️❌ You forgot to run the command 'pnpm registry:build' before committing. ⚔️❌"
  echo "I have run this for you."
  echo "Please stage the file in $TARGET_FILE before committing."
  echo "And, don't forget to run the command next time before committing!"
  exit 1
else
  echo "🎉 No unstaged changes in $TARGET_FILE. Proceeding with commit.✨🚀🏹🛡️"
  exit 0
fi
